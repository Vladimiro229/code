<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ö–æ–¥–∏ –≤–∏—Ä–æ–±—ñ–≤ ‚Äî —Å–ø–∏—Å–æ–∫ –¥–ª—è –¥–∏–∑–∞–π–Ω–µ—Ä—ñ–≤</title>
  <style>
    :root{
      --bg:#e6e6e6;--card:#ffffff;--text:#111;--muted:#6b7280;--radius:14px;--shadow:0 6px 18px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:"Segoe UI",system-ui,-apple-system,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}
    .wrap{max-width:1100px;margin:0 auto;padding:28px 16px}
    header{display:flex;align-items:end;justify-content:space-between;margin-bottom:18px}
    h1{font-size:26px;margin:0;font-weight:700}
    .hint{font-size:12px;color:var(--muted)}

    .section{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:18px;overflow:hidden}
    .section h2{margin:0;padding:14px 16px;font-size:16px;border-bottom:1px solid #efefef}

    .list{display:flex;flex-direction:column;padding:8px}
    .row{display:flex;gap:12px;align-items:center;border:1px solid #eee;border-radius:12px;padding:10px 12px;margin:6px;cursor:pointer;transition:.15s transform, .15s box-shadow;background:#fff}
    .row:hover{transform:translateY(-1px);box-shadow:0 8px 24px rgba(0,0,0,.06)}

    .code{font-family:ui-monospace, Menlo, Consolas, "Liberation Mono", monospace;background:#111;color:#fff;border-radius:8px;padding:6px 10px;white-space:nowrap}
    .meta{display:flex;gap:8px;flex-wrap:wrap;min-width:0}
    .chip{border:1px solid #e5e7eb;border-radius:999px;padding:4px 10px;font-size:12px;background:#fafafa;white-space:nowrap}
    .muted{color:var(--muted)}
    footer{text-align:center;margin-top:10px;color:var(--muted);font-size:12px}

    .toast{position:fixed;left:50%;bottom:28px;transform:translateX(-50%);background:#111;color:#fff;border-radius:12px;padding:10px 14px;opacity:0;pointer-events:none;transition:.25s}
    .toast.show{opacity:1}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>–ö–æ–¥–∏ –¥–ª—è –º–∞–∫–µ—Ç—ñ–≤</h1>
      <div class="hint">–ù–∞—Ç–∏—Å–Ω–∏ –Ω–∞ —Ä—è–¥–æ–∫ ‚Äî –∫–æ–¥ —Å–∫–æ–ø—ñ—é—î—Ç—å—Å—è —É –±—É—Ñ–µ—Ä. –î–∞–Ω—ñ —Ç—è–≥–Ω—É—Ç—å—Å—è –∑ Google Sheets.</div>
    </header>

    <div id="container"></div>
    <footer>–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: <span id="updated">‚Äî</span></footer>
  </div>

  <div id="toast" class="toast">–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ</div>

  <script>
    // ===== –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è =====
    const API_KEY = "AIzaSyB2l87TIEyJwO1BMDkE_IHMaXG6k2N3rEw"; // —Ç–≤—ñ–π –∫–ª—é—á
    const SPREADSHEET_ID = "1OfyrwUBOLyQzpbjzGbIwGIpkc6iPwuwkGFaWWSU2uao";              // üëâ –≤—Å—Ç–∞–≤ —Å–≤—ñ–π ID
    const SHEET_NAME = "–ö–æ–¥–∏";                                  // –Ω–∞–∑–≤–∞ –∞—Ä–∫—É—à–∞
    const RANGE = `${SHEET_NAME}!A1:K`;                          // –ø—ñ–¥–ª–∞—à—Ç—É–π –∑–∞ –ø–æ—Ç—Ä–µ–±–∏

    // –Ø–∫ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—é —Ç–∞ –∫–æ–¥
    const TECHNOLOGY_HEADERS = ["–¢–¶", "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—è", "–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó", "Tech"]; // —É —Å–∫—Ä—ñ–Ω—ñ –∫–æ–ª–æ–Ω–∫–∞ ¬´–¢–¶: ...¬ª
    const CODE_HEADERS = ["–ö–æ–¥", "Code", "–ê—Ä—Ç–∏–∫—É–ª", "–ù–∞–∑–≤–∞ –∫–æ–¥—É"];        // —â–æ –∫–æ–ø—ñ—é—î–º–æ

    // –Ø–∫—ñ –ø–æ–ª—è –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ —è–∫ —á—ñ–ø–∏ –ø—ñ–¥ –∫–æ–¥–æ–º (—É –ø–æ—Ä—è–¥–∫—É –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç—É, —è–∫—â–æ —ñ—Å–Ω—É—é—Ç—å)
    const CHIP_CANDIDATES = [
      "–°—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω–∏–π —Ü–∏—Ñ—Ä.", "–°—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω—ñ —Ü–∏—Ñ—Ä.", "–°—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω—ñ —Ü–∏—Ñ—Ä–∏", "–¶–∏—Ñ–µ—Ä–±–ª–∞—Ç",
      "–®–∞—Ä–∏", "–û–¥–∏–Ω–æ—á–∫–æ–≤–∏–π", "–î–≤–æ—à–∞—Ä–æ–≤–∏–π",
      "–ú–∞—Ç–µ—Ä—ñ–∞–ª", "–ê–ª—é–º—ñ–Ω—ñ–π", "–ì—ñ–ª—å–∑–∞",
      "2D –º—ñ—Ç–∫–∏", "3D –º—ñ—Ç–∫–∏", "–ù–∞–ø–∏–ª–æ–∫"
    ];

    const TECH_ORDER = ["–£–§", "–õ–∞–∑–µ—Ä", "–£–§+–õ–∞–∑–µ—Ä", "–õ–∞–∑–µ—Ä+–£–§"]; // –ø–æ—Ä—è–¥–æ–∫ —Å–µ–∫—Ü—ñ–π

    // ===== –°—Ç–∞–Ω =====
    let headers = [];
    let rows = [];
    let codeKey = null;
    let techKey = null;

    const $ = (s)=>document.querySelector(s);
    const container = $("#container");
    const toastEl = $("#toast");

    // ===== –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑ Sheets =====
    async function load(){
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${encodeURIComponent(RANGE)}?key=${API_KEY}`;
      const res = await fetch(url);
      if(!res.ok) throw new Error("–ù–µ –≤–¥–∞–ª–æ—Å—å –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞–Ω—ñ –∑ Google Sheets");
      const json = await res.json();
      const values = json.values||[];
      if(!values.length) return;
      headers = values[0];
      const data = values.slice(1);
      rows = data.map(r => Object.fromEntries(headers.map((h,i)=>[h, r[i] ?? ""])));

      techKey = headers.find(h => TECHNOLOGY_HEADERS.some(x => h.toLowerCase().includes(x.toLowerCase()))) || headers[1];
      codeKey = headers.find(h => CODE_HEADERS.includes(h)) || headers[0];

      render();
      $("#updated").textContent = new Date().toLocaleString();
    }

    // ===== –†–µ–Ω–¥–µ—Ä —Å–µ–∫—Ü—ñ–π –∑–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è–º–∏ =====
    function render(){
      const groups = {};
      rows.forEach(row=>{
        const raw = (row[techKey]||"").toString().toLowerCase();
        const tech = normalizeTech(raw);
        (groups[tech] ||= []).push(row);
      });

      container.innerHTML = "";
      TECH_ORDER.concat(Object.keys(groups).filter(k=>!TECH_ORDER.includes(k))).forEach(tech=>{
        if(!groups[tech]||!groups[tech].length) return;
        const sec = document.createElement('section');
        sec.className = 'section';
        sec.innerHTML = `<h2>${tech}</h2><div class="list"></div>`;
        const list = sec.querySelector('.list');
        groups[tech].forEach(row=> list.appendChild(renderRow(row)) );
        container.appendChild(sec);
      });
    }

    function renderRow(row){
      const el = document.createElement('div');
      el.className = 'row';
      const code = row[codeKey] || row[headers[0]] || '';
      const chips = makeChips(row);
      el.innerHTML = `
        <div class="code" title="–ù–∞—Ç–∏—Å–Ω–∏, —â–æ–± —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –∫–æ–¥">${escapeHtml(code)}</div>
        <div class="meta">${chips.map(c=>`<span class=\"chip\">${escapeHtml(c)}</span>`).join('')}</div>
      `;
      el.addEventListener('click', ()=>copy(code));
      return el;
    }

    function makeChips(row){
      const found = [];
      CHIP_CANDIDATES.forEach(name=>{
        const key = headers.find(h=>h.toLowerCase()===name.toLowerCase());
        if(key && row[key]) found.push(`${key}: ${row[key]}`);
      });
      // –Ø–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ —Å–ø—ñ–≤–ø–∞–ª–æ ‚Äî –ø–æ–∫–∞–∂–µ–º–æ 2-3 –ø–µ—Ä—à—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ñ –∫–æ–ª–æ–Ω–∫–∏ –ø—ñ—Å–ª—è –∫–æ–¥—É
      if(!found.length){
        headers.slice(1,4).forEach(h=>{ if(row[h]) found.push(`${h}: ${row[h]}`); });
      }
      return found;
    }

    function normalizeTech(s){
      // –Ω–æ—Ä–º–∞–ª—ñ–∑—É—î–º–æ —Ä—ñ–∑–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è
      if(s.includes('—É—Ñ') && s.includes('–ª–∞–∑')) return s.indexOf('—É—Ñ') < s.indexOf('–ª–∞–∑') ? '–£–§+–õ–∞–∑–µ—Ä' : '–õ–∞–∑–µ—Ä+–£–§';
      if(s.includes('—É—Ñ')) return '–£–§';
      if(s.includes('–ª–∞–∑')) return '–õ–∞–∑–µ—Ä';
      return '–Ü–Ω—à–µ';
    }

    async function copy(text){
      if(!text) return;
      try{ await navigator.clipboard.writeText(text); showToast('–°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ: ' + text); }
      catch{ showToast('–ù–µ –≤–¥–∞–ª–æ—Å—å —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏'); }
    }

    function showToast(msg){
      toastEl.textContent = msg; toastEl.classList.add('show');
      setTimeout(()=>toastEl.classList.remove('show'), 1500);
    }

    function escapeHtml(str){
      return String(str).replace(/[&<>"']/g, s=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[s]));
    }

    load().catch(e=>{ console.error(e); showToast('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è'); });
  </script>
</body>
</html>
